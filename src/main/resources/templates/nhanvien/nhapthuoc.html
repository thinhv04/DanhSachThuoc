<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Nh·∫≠p Thu·ªëc</title>

    <!-- Bootstrap 5 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" />

    <!-- Font + Style -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
        }

        .sidebar {
            width: 250px;
            min-height: 100vh;
            background: #343a40;
            padding: 20px;
            position: fixed;
            top: 0;
            left: 0;
            color: white;
        }

        .sidebar .nav-link {
            color: white;
            font-size: 16px;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s ease-in-out;
        }

        .sidebar .nav-link:hover {
            background-color: #495057;
        }

        .content {
            margin-left: 270px;
            padding: 20px;
        }

        .hero-section {
            background: linear-gradient(135deg, #6f42c1, #007bff);
            color: white;
            padding: 40px;
            border-radius: 10px;
        }
        .custom-toast {
            font-size: 1.1rem;           /* TƒÉng c·ª° ch·ªØ */
            padding: 1rem 1.25rem;       /* TƒÉng padding */
            border-radius: 10px;         /* Bo g√≥c m·ªÅm m·∫°i h∆°n */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); /* ƒê·ªï b√≥ng r√µ h∆°n */
            min-width: 300px;            /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu */
            max-width: 500px;            /* Chi·ªÅu r·ªông t·ªëi ƒëa */
        }
    </style>
</head>

<body>

    <!-- Sidebar -->
    <div th:replace="~{nhanvien/menu :: menu}"></div>

    <!-- Main Content -->
    <div class="content">
        <div class="hero-section mb-4">
            <h2 class="text-center">üë®‚Äç‚öïÔ∏è Nh√¢n Vi√™n Y T·∫ø - Tr√°ch Nhi·ªám & S·ª© M·ªánh</h2>
            <p class="mt-3">
                Nh√¢n vi√™n y t·∫ø ƒë√≥ng vai tr√≤ quan tr·ªçng trong h·ªá th·ªëng chƒÉm s√≥c s·ª©c kh·ªèe, ƒë·∫∑c bi·ªát l√† vi·ªác qu·∫£n l√Ω thu·ªëc.
                H·ªç kh√¥ng ch·ªâ ƒë·∫£m b·∫£o thu·ªëc ƒë∆∞·ª£c nh·∫≠p ƒë√∫ng quy tr√¨nh m√† c√≤n theo d√µi ch·∫•t l∆∞·ª£ng v√† s·ªë l∆∞·ª£ng thu·ªëc trong
                kho.
            </p>
            <ul>
                <li>üì¶ <strong>Qu·∫£n l√Ω nh·∫≠p thu·ªëc:</strong> Ki·ªÉm tra v√† ghi nh·∫≠n s·ªë l∆∞·ª£ng thu·ªëc m·ªõi nh·∫≠p.</li>
                <li>üìä <strong>Theo d√µi kho thu·ªëc:</strong> C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng thu·ªëc c√≤n trong kho theo th·ªùi gian th·ª±c.
                </li>
                <li>üí¨ <strong>T∆∞ v·∫•n & h·ªó tr·ª£:</strong> H·ªó tr·ª£ b√°c sƒ© v√† b·ªánh nh√¢n v·ªÅ vi·ªác s·ª≠ d·ª•ng thu·ªëc an to√†n.</li>
            </ul>
        </div>

        <div class="container mt-5">
            <h2 class="text-center mb-4">Nh·∫≠p Thu·ªëc</h2>

            <!-- Th√¥ng b√°o Toast -->
            <div class="position-fixed top-0 end-0 p-3" style="z-index: 1050;">
                <div class="toast align-items-center text-bg-success border-0 custom-toast" id="successToast" role="alert"
                    th:if="${successMessage}" data-bs-delay="3000">
                    <div class="d-flex">
                        <div class="toast-body">
                            <span th:text="${successMessage}"></span>
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                            aria-label="Close"></button>
                    </div>
                </div>

                <div class="toast align-items-center text-bg-danger border-0 custom-toast" id="errorToast" role="alert"
                    th:if="${errorMessage}" data-bs-delay="4000">
                    <div class="d-flex">
                        <div class="toast-body">
                            <span th:text="${errorMessage}"></span>
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                            aria-label="Close"></button>
                    </div>
                </div>
            </div>

            <!-- Form Nh·∫≠p Thu·ªëc -->
            <form th:action="@{/nhanvien/trangchu/nhapthuoc/them}" method="post" th:object="${nhapThuoc}"
                class="needs-validation" novalidate>
                <input type="hidden" th:field="*{nhanVien.maNhanVien}">

                <div class="mb-3">
                    <label class="form-label">M√£ Nh√¢n Vi√™n</label>
                    <input type="text" class="form-control" readonly
                        th:value="${nhanVien != null ? nhanVien.maNhanVien + ' - ' + nhanVien.hoTen : ''}">
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <label class="form-label">Ch·ªçn M√£ Thu·ªëc</label>
                        <select class="form-select" th:field="*{thuoc.maThuoc}" required>
                            <option value="">-- Ch·ªçn thu·ªëc --</option>
                            <option th:each="thuoc : ${thuocList}" th:value="${thuoc.maThuoc}"
                                th:text="${thuoc.maThuoc + ' - ' + thuoc.tenThuoc}"></option>
                        </select>
                        <div class="invalid-feedback">Vui l√≤ng ch·ªçn thu·ªëc.</div>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">S·ªë L∆∞·ª£ng Nh·∫≠p</label>
                        <input type="number" class="form-control" th:field="*{soLuongNhap}" required min="1">
                        <div class="invalid-feedback">Nh·∫≠p s·ªë l∆∞·ª£ng h·ª£p l·ªá.</div>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Ng√†y Nh·∫≠p</label>
                        <input type="date" class="form-control" th:field="*{ngayNhap}" required>
                        <div class="invalid-feedback">Vui l√≤ng ch·ªçn ng√†y nh·∫≠p.</div>
                    </div>
                </div>

                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="form-label">Nh√† Cung C·∫•p</label>
                        <input type="text" class="form-control" th:field="*{nhaCungCap}" required>
                        <div class="invalid-feedback">Nh·∫≠p t√™n nh√† cung c·∫•p.</div>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Ghi Ch√∫</label>
                        <textarea class="form-control" th:field="*{ghiChu}"></textarea>
                    </div>
                </div>

                <!-- C√°c n√∫t ch·ª©c nƒÉng -->
                <div class="d-flex justify-content-between align-items-center mt-4">
                    <div>
                        <a th:href="@{/nhanvien/trangchu/thuoc}" class="btn btn-outline-secondary me-2">+ Th√™m thu·ªëc
                            m·ªõi</a>
                        <a th:href="@{/nhanvien/trangchu/khothuoc/list}" class="btn btn-outline-primary">Xem Kho
                            Thu·ªëc</a>
                    </div>
                    <button type="submit" class="btn btn-success">Nh·∫≠p Thu·ªëc</button>
                </div>
            </form>
            <!-- Danh s√°ch nh·∫≠p thu·ªëc -->
            <h3 class="text-center">Danh S√°ch Nh·∫≠p Thu·ªëc</h3>
            <table id="tableNhapThuoc" class="table table-bordered table-hover table-striped">
                <thead class="table-dark text-center">
                    <tr>
                        <th>M√£ Nh·∫≠p</th>
                        <th>M√£ Nh√¢n Vi√™n</th>
                        <th>M√£ Thu·ªëc</th>
                        <th>S·ªë L∆∞·ª£ng Nh·∫≠p</th>
                        <th>Ng√†y Nh·∫≠p</th>
                        <th>Nh√† Cung C·∫•p</th>
                        <th>Ghi Ch√∫</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="nhap : ${nhapThuocList}">
                        <td th:text="${nhap.maNhapThuoc}"></td>
                        <td th:text="${nhap.nhanVien != null ? nhap.nhanVien.maNhanVien : 'N/A'}"></td>
                        <td th:text="${nhap.thuoc != null ? nhap.thuoc.maThuoc : 'N/A'}"></td>
                        <td th:text="${nhap.soLuongNhap}"></td>
                        <td th:text="${#temporals.format(nhap.ngayNhap, 'dd/MM/yyyy')}"></td>
                        <td th:text="${nhap.nhaCungCap}"></td>
                        <td th:text="${nhap.ghiChu}"></td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(nhapThuocList)}">
                        <td colspan="7" class="text-center text-danger">Ch∆∞a c√≥ d·ªØ li·ªáu nh·∫≠p thu·ªëc!</td>
                    </tr>
                </tbody>
            </table>

        </div>
    </div>

    <!-- jQuery + DataTables -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <!-- ‚úÖ B·ªî SUNG: Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


    <!-- K√≠ch ho·∫°t DataTables -->
    <script>

        // Bootstrap Toast
        window.addEventListener('DOMContentLoaded', (event) => {
            const successToastEl = document.getElementById('successToast');
            const errorToastEl = document.getElementById('errorToast');

            if (successToastEl) new bootstrap.Toast(successToastEl).show();
            if (errorToastEl) new bootstrap.Toast(errorToastEl).show();
        });

        // Bootstrap validation
        (() => {
            'use strict';
            const forms = document.querySelectorAll('.needs-validation');
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();
        // --------------------
        $(document).ready(function () {
            $('#tableNhapThuoc').DataTable({
                language: {
                    search: "üîç T√¨m ki·∫øm:",
                    lengthMenu: "Hi·ªÉn th·ªã _MENU_ d√≤ng",
                    info: "Hi·ªÉn th·ªã _START_ ƒë·∫øn _END_ c·ªßa _TOTAL_ d√≤ng",
                    paginate: {
                        first: "Trang ƒë·∫ßu",
                        last: "Trang cu·ªëi",
                        next: "‚û°Ô∏è",
                        previous: "‚¨ÖÔ∏è"
                    },
                    emptyTable: "Kh√¥ng c√≥ d·ªØ li·ªáu",
                    zeroRecords: "Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ ph√π h·ª£p"
                }
            });
        });
    </script>


</body>

</html>